<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Aulas - Natação</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1><i class="fas fa-swimmer"></i> Academia de Natação</h1>
            <p>Controle de Aulas - Professoras Daniele e Isabela</p>
            <div class="status" id="syncStatus">
                <i class="fas fa-sync-alt"></i> <span>Conectado ao Google Sheets</span>
            </div>
        </header>

        <!-- Dashboard -->
        <section class="dashboard">
            <div class="cards">
                <div class="card">
                    <h3><i class="fas fa-calendar-alt"></i> Hoje</h3>
                    <p class="value" id="totalHoje">0</p>
                    <p class="subtitle">aulas hoje</p>
                </div>
                <div class="card card-daniele">
                    <h3><i class="fas fa-user-tie"></i> Daniele</h3>
                    <p class="value" id="totalDaniele">0</p>
                    <p class="subtitle">aulas totais</p>
                </div>
                <div class="card card-isabela">
                    <h3><i class="fas fa-user-tie"></i> Isabela</h3>
                    <p class="value" id="totalIsabela">0</p>
                    <p class="subtitle">aulas totais</p>
                </div>
                <div class="card">
                    <h3><i class="fas fa-chart-line"></i> Este Mês</h3>
                    <p class="value" id="totalMes">0</p>
                    <p class="subtitle">aulas no mês</p>
                </div>
            </div>
        </section>

        <!-- Formulário -->
        <section class="form-section">
            <h2><i class="fas fa-plus-circle"></i> Lançar Nova Aula</h2>
            <form id="formAula">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="data"><i class="far fa-calendar"></i> Data</label>
                        <input type="date" id="data" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="professora"><i class="fas fa-chalkboard-teacher"></i> Professora</label>
                        <select id="professora" required>
                            <option value="">Selecione...</option>
                            <option value="Daniele">Daniele</option>
                            <option value="Isabela">Isabela</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="quantidade"><i class="fas fa-list-ol"></i> Quantidade</label>
                        <div class="quantity-controls">
                            <button type="button" class="qty-btn" onclick="adjustQuantity(-1)">-</button>
                            <input type="number" id="quantidade" min="1" max="10" value="1" required>
                            <button type="button" class="qty-btn" onclick="adjustQuantity(1)">+</button>
                        </div>
                        <small>Número de aulas dadas</small>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="fas fa-cloud-upload-alt"></i> Salvar no Google Sheets
                </button>
            </form>
            
            <div class="form-tips">
                <p><i class="fas fa-lightbulb"></i> Dica: Os dados são salvos instantaneamente na sua planilha do Google!</p>
            </div>
        </section>

        <!-- Gráficos -->
        <section class="charts-section">
            <h2><i class="fas fa-chart-bar"></i> Estatísticas</h2>
            <div class="charts-row">
                <div class="chart-container">
                    <h3>Distribuição por Professora</h3>
                    <canvas id="chartProfessoras"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Últimos 7 Dias</h3>
                    <canvas id="chartSemanal"></canvas>
                </div>
            </div>
        </section>

        <!-- Registros Recentes -->
        <section class="table-section">
            <h2><i class="fas fa-history"></i> Registros Recentes</h2>
            
            <div class="table-controls">
                <div class="filter-group">
                    <label for="filtroPeriodo"><i class="fas fa-filter"></i> Período:</label>
                    <select id="filtroPeriodo" onchange="filtrarTabela()">
                        <option value="hoje">Hoje</option>
                        <option value="ontem">Ontem</option>
                        <option value="semana">Esta Semana</option>
                        <option value="mes">Este Mês</option>
                        <option value="todos">Todos</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="filtroProfessora">Professora:</label>
                    <select id="filtroProfessora" onchange="filtrarTabela()">
                        <option value="">Todas</option>
                        <option value="Daniele">Daniele</option>
                        <option value="Isabela">Isabela</option>
                    </select>
                </div>
                
                <button onclick="carregarDados()" class="btn btn-secondary">
                    <i class="fas fa-sync"></i> Atualizar
                </button>
                
                <button onclick="exportarParaExcel()" class="btn btn-success">
                    <i class="fas fa-file-excel"></i> Exportar Excel
                </button>
            </div>
            
            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Dia</th>
                            <th>Professora</th>
                            <th>Qtd. Aulas</th>
                            <th>Registrado em</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaAulas">
                        <!-- Dados carregados via JavaScript -->
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3"><strong>Total do período:</strong></td>
                            <td id="totalPeriodo">0</td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            
            <div class="table-info">
                <p><i class="fas fa-info-circle"></i> Mostrando <span id="totalRegistros">0</span> registros</p>
            </div>
        </section>

        <!-- Resumo por Professora -->
        <section class="summary-section">
            <h2><i class="fas fa-user-tie"></i> Resumo por Professora</h2>
            <div class="summary-cards">
                <div class="summary-card daniele">
                    <div class="summary-header">
                        <h3><i class="fas fa-user-tie"></i> Daniele</h3>
                        <span class="badge-daniele">Total: <span id="resumoDaniele">0</span></span>
                    </div>
                    <div class="summary-body">
                        <div class="summary-item">
                            <span class="label">Este Mês:</span>
                            <span class="value" id="danieleMes">0</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Esta Semana:</span>
                            <span class="value" id="danieleSemana">0</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Média/Dia:</span>
                            <span class="value" id="danieleMedia">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="summary-card isabela">
                    <div class="summary-header">
                        <h3><i class="fas fa-user-tie"></i> Isabela</h3>
                        <span class="badge-isabela">Total: <span id="resumoIsabela">0</span></span>
                    </div>
                    <div class="summary-body">
                        <div class="summary-item">
                            <span class="label">Este Mês:</span>
                            <span class="value" id="isabelaMes">0</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Esta Semana:</span>
                            <span class="value" id="isabelaSemana">0</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Média/Dia:</span>
                            <span class="value" id="isabelaMedia">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Configuração -->
        <section class="config-section">
            <h2><i class="fas fa-cog"></i> Configuração do Google Sheets</h2>
            <div class="config-card">
                <p><i class="fas fa-info-circle"></i> Para configurar a integração:</p>
                <ol>
                    <li>Abra sua planilha no Google Sheets</li>
                    <li>Vá em <strong>Extensões → Apps Script</strong></li>
                    <li>Cole o código fornecido</li>
                    <li>Clique em <strong>Implantar → Nova implantação</strong></li>
                    <li>Selecione <strong>Web App</strong> e defina acesso para "Qualquer pessoa"</li>
                    <li>Copie a URL gerada e cole abaixo:</li>
                </ol>
                
                <div class="config-input">
                    <label for="scriptUrl">URL do Google Apps Script:</label>
                    <input type="text" id="scriptUrl" placeholder="https://script.google.com/macros/s/.../exec">
                    <button onclick="salvarConfig()" class="btn btn-primary">
                        <i class="fas fa-save"></i> Salvar URL
                    </button>
                </div>
                
                <div class="config-test">
                    <button onclick="testarConexao()" class="btn btn-secondary">
                        <i class="fas fa-wifi"></i> Testar Coneexão
                    </button>
                    <span id="testResult"></span>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <p>© 2024 Academia de Natação - Sistema desenvolvido para controle de aulas</p>
            <p class="footer-links">
                <span><i class="fas fa-sync-alt"></i> Sincronizado com Google Sheets</span>
                <span><i class="fas fa-mobile-alt"></i> Totalmente responsivo</span>
                <span><i class="fas fa-shield-alt"></i> Dados seguros na sua conta Google</span>
            </p>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay">
        <div class="loading-content">
            <i class="fas fa-spinner fa-spin fa-3x"></i>
            <p>Sincronizando com Google Sheets...</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="google-sheets.js"></script>
    <script src="app.js"></script>
    
    <script>
        // Funções globais simples
        function adjustQuantity(change) {
            const input = document.getElementById('quantidade');
            let value = parseInt(input.value) + change;
            if (value < 1) value = 1;
            if (value > 10) value = 10;
            input.value = value;
        }
        
        function filtrarTabela() {
            if (window.filtrarRegistros) {
                window.filtrarRegistros();
            }
        }
        
        function exportarParaExcel() {
            if (window.exportarExcel) {
                window.exportarExcel();
            }
        }
        
        function salvarConfig() {
            if (window.salvarConfiguracao) {
                window.salvarConfiguracao();
            }
        }
        
        function testarConexao() {
            if (window.testarConexaoSheets) {
                window.testarConexaoSheets();
            }
        }
        
        function carregarDados() {
            if (window.carregarDadosSheets) {
                window.carregarDadosSheets();
            }
        }
    </script>
</body>
</html>